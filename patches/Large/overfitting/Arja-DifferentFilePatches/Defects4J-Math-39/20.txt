--- /tmp/Arja_Defects4J_Math_39/src/main/java/org/apache/commons/math/ode/nonstiff/DormandPrince853StepInterpolator.java	2018-12-01 06:15:54.854605791 -0500
+++ /tmp/Arja_Defects4J_Math_39/patches_69e6/Patch_1098/patched/tmp/Arja_Defects4J_Math_39/src/main/java/org/apache/commons/math/ode/nonstiff/DormandPrince853StepInterpolator.java	2018-12-01 07:28:31.645055944 -0500
@@ -290,7 +290,8 @@
     final int dimension = currentState.length;
 
     yDotKLast = new double[3][];
-    for (int k = 0; k < yDotKLast.length; ++k) {
+    reinitialize(y, forward, primaryMapper, secondaryMappers);
+	for (int k = 0; k < yDotKLast.length; ++k) {
       yDotKLast[k] = new double[dimension];
     }
 


--- /tmp/Arja_Defects4J_Math_39/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java	2018-12-01 06:15:58.330605737 -0500
+++ /tmp/Arja_Defects4J_Math_39/patches_69e6/Patch_1098/patched/tmp/Arja_Defects4J_Math_39/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java	2018-12-01 07:28:31.649055925 -0500
@@ -259,7 +259,11 @@
             yTmp[j] = y[j] + stepSize * sum;
           }
 
-          computeDerivatives(stepStart + c[k-1] * stepSize, yTmp, yDotK[k]);
+          if ((forward && (stepStart + stepSize > t))
+				|| ((!forward) && (stepStart + stepSize < t))) {
+			stepSize = t - stepStart;
+		}
+		computeDerivatives(stepStart + c[k-1] * stepSize, yTmp, yDotK[k]);
 
         }
 


